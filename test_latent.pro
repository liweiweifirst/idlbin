pro test_latent
bkgd =  [29661.612714,3423.501090,  6840.136297,  9484.235812,  420.972953,  1512.674391,  1469.131534, 2317.311718,  485.077039,  963.675633,  1217.530719,  74266.684130,  6468.494853, 1158.485437,  11520.083831,  1631.226046,  532.173448,  813.579517,  3668.731918, 894.309241,  692.032491,  2142.951504,  420.972953,  29661.612714,  599.612701, 6260.187763,  2726.440607,  26528.780213,  2142.951504,  1571.578563,  420.972953, 74266.684130,  2125.046452,  794.059643,  6840.136297,  766.730490,  3946.222822, 466.031395,  9448.722065,  2142.951504,  1353.630626,  599.612701,  963.675633, 763.326461,  1217.530719,  794.059643,  1799.965630,  4554.555101,  795.518179, 1397.746781,  794.059643,  1571.578563,  820.471281,  2573.479345,  606.502303, 2317.311718,  3423.501090,  1138.966715,  2995.764191,  74266.684130,  606.502303, 753.928780,  1036.948733,  763.326461,  3837.004770,  1737.007731,  2125.046452, 15336.682174,  5451.829272,  75310.274349,  32567.195197,  56667.153828,  29661.612714, 3902.889455,  1308.030242,  11520.083831,  1138.966715,  795.518179,  599.612701, 2142.951504,  9484.235812,  532.173448,  1353.630626,  795.518179,  3902.889455, 1217.530719,  2502.901667,  9448.722065,  1631.226046,  894.535468,  3837.004770, 819.178416,  819.178416,  3423.501090,  8066.665216,  606.502303,  8066.665216, 1227.548198 , 19719.283675 , 485.077039]

bkgd=[ 6820.575892, 5953.120255,  7959.532450,  5632.420362,  5397.773550,  7959.532450,  8236.702877, 9680.808604,  7479.312361,  6142.803066,  6820.575892,  5268.132849,  7175.119022, 8229.879961,  7288.047458,  7845.649195,  5393.135963,  5434.036784,  5821.735052, 34166.125092,  6542.936874,  29202.235503,  10890.858678,  5601.591758,  5361.907598, 8461.426268,  6211.351183,  41069.304786,  6073.985097,  10780.669898,  15349.855103, 30521.059284,  29202.235503,  38784.466230,  30483.852697,  6770.183831,  5821.735052, 13616.681450,  14839.113396,  6770.183831,  5641.589411,  13616.681450,  33779.552757, 12388.932237,  5313.879950,  6770.183831,  10531.135242,  8461.426268,  5605.159008, 6770.183831,  8461.426268,  29202.235503,  5454.209568,  8229.879961,  7448.222243, 10890.858678,  5397.773550,  5528.393956,  7959.532450,  5601.537618,  6202.739292, 5587.145763,  10768.614565,  6536.754557,  12388.932237,  6542.936874,  5365.197622, 11770.675452,  5866.672964,  5250.817324,  8215.428931,  7861.923202,  8461.426268, 58018.913480,  5601.591758,  5466.395451,  5578.657840,  6149.761659,  5526.832769, 33779.552757,  7479.312361,  6386.448674,  58018.913480,  11770.675452,  5335.288758, 5472.028982,  12391.440538,  6139.161791,  5437.286143,  33897.617577,  13616.681450, 5466.395451,  5818.391565,  5587.145763,  7448.222243,  5507.630918,  7126.190487, 5526.832769,  6142.803066,  5442.268891]

bkgd=[-133.089714, -453.391371,  3796.163313,  660.285551,  1933.030207,  -1.582701,  5557.671607, -106.481295,  2189.121302,  -107.677560,  -107.677560,  28329.111743,  -252.563938, 1059.591296,  -150.106230,  -387.524927,  -327.160029,  845.881670,  -595.575310, 5120.996251,  -499.669338,  2189.121302,  3388.259314,  71383.224813,  78.426003, 12907.171403,  -107.677560,  -141.643393,  5938.368469,  709.979150,  -285.309943, -341.791642,  819.475147,  -233.254578,  -150.106230,  5938.368469,  -595.575310, 1059.591296,  -341.791642,  -498.799532,  -362.325119,  -423.379166,  819.475147, -204.563241,  -141.643393,  29.882286,  3285.173746,  -543.238913,  -466.188562, 3388.259314,  28.270781,  5120.996251,  -482.850594,  3569.800508,  4735.968160, 1322.437936,  -1.582701,  845.881670,  3353.543144,  3561.325483,  2481.240373, 785.313619,  -61.010480,  660.285551,  3285.173746,  -242.999404,  -28.017758, 1059.591296,  -450.175257,  -1.582701,  -233.254578,  -93.043752,  709.979150, 1059.591296,  1059.591296,  -403.611261,  -179.203376,  3727.401642,  61939.262669, 5557.671607,  3285.173746,  -482.850594,  -406.254806,  -153.581168,  -499.669338, 76669.103971,  1059.591296,  3796.163313,  -269.237498,  3353.543144,  2481.240373, -450.175257,  -106.481295,  -107.677560,  -150.106230,  -406.254806,  1322.437936, -411.965168,  1955.378606,  -341.791642]


 print, 'before medclip, min, max, med, sig', min(bkgd), max(bkgd), median(bkgd), stddev(bkgd)

 skpix = MEDCLIP(bkgd, med, sigma, clipsig = 3, converge_num = 0.03)
 print, 'after medclip', n_elements(skpix), min(skpix), max(skpix)
 
 
;fit a gaussian to this distribution
 binsize = 200           
 plothist, skpix, xhist, yhist, bin = binsize, xrange = [-10000,10000] ,/noplot ;make a histogram of the data
 print, 'plothist xhist', xhist
 print, 'plothist yhist', yhist
 
 start = [mean(skpix),stddev(skpix), 2.]
                                ; print, 'start', start
 noise = fltarr(n_elements(yhist))
 noise[*] = 1  
                                ;equally weight the values
 result= MPFITFUN('mygauss',xhist,yhist, noise, start) ; fit a gaussian to the histogram sorted data
 bkg = result(0)
 
end
