pro bias_final

;ch1

exptime=[0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200,0.1,0.4,2,6,12,100,200]

vreset=[-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.4,-3.4,-3.4,-3.4,-3.4,-3.4,-3.4,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6]

bias = [400,400,400,400,400,400,400,400,400,400,400,400,400,400,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,500,500,500,500,500,500,500,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750,750]

vdduc = [-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.1,-3.1,-3.1,-3.1,-3.1,-3.1,-3.1,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.6,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.1,-3.1,-3.1,-3.1,-3.1,-3.1,-3.1]

vgg1=[-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-4,-4,-4,-4,-4,-4,-4,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.65,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-3.68,-4,-4,-4,-4,-4,-4,-4,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.55,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75,-3.75]

newmean=[0,0,0,0,0,0,0,9.4671,3.11674,0.430667,0.153537,0.08917,0.013684,0.00757,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.68352,2.60043,0.352886,0.12483,0.07259,0.01158,0.00651,7.25204,2.41305,0.32724,0.114376,0.0669717,0.010891,0.006329,0,0,0,0,0,0,0,6.9264,2.2677,0.30676,0.1067,0.06187,0.010418,0.006104,7.1663,2.3276,0.31282,0.109368,0.06362,0.010526,0.00616,0,0,0,0,0,0,0,7.2982,2.24165,0.291536,0.09957,0.0606498,0.01776096,0.014895,0,0,0,0,0,0,0]

noisypix=[0,0,0,0,0,0.00132706,0,0,0,0,0,0,0.0014235,0,0,0,0,0,0,0.00321454,0,0,0,0,0,0,0.00265115,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00276443,0,0,0,0,0,0,0.00298852,0,0,0,0,0,0,0.00333561,0,0,0,0,0,0,0.00272027,0,0,0,0,0,0,0.00234329,0,0,0,0,0,0,0.00489427,0,0,0,0,0,0,0.00782853,0,0,0,0,0,0,0.00829157,0,0,0,0,0,0,0.00855288,0,0,0,0,0,0,0.051382,0,0,0,0,0,0,0.136233,0,0,0,0,0,0,0.118043,0]

lstrength=[0.00205113,0.00205113,0.00205113,0.00205113,0.00205113,0.00205113,0.00205113,0.00184746,0.00180663,0.00180663,0.00180663,0.00180663,0.00180663,0.00180663,0.00260332,0.00260332,0.00260332,0.00260332,0.00260332,0.00260332,0.00260332,0.00222764,0.00222764,0.00222764,0.00222764,0.00222764,0.00222764,0.00222764,0.00117899,0.00117899,0.00117899,0.00117899,0.00117899,0.00117899,0.00117899,0.00224228,0.00224228,0.00224228,0.00224228,0.00224228,0.00224228,0.00224228,0.00235581,0.00235581,0.00235581,0.00235581,0.00235581,0.00235581,0.00235581,0.00161768,0.00161768,0.00161768,0.00161768,0.00161768,0.00161768,0.00161768,0.00184746,0.00184746,0.00184746,0.00184746,0.00184746,0.00184746,0.00184746,0.00231879,0.00231879,0.00231879,0.00231879,0.00231879,0.00231879,0.00231879,0.00223464,0.00223464,0.00223464,0.00223464,0.00223464,0.00223464,0.00223464,0.00172491,0.00172491,0.00172491,0.00172491,0.00172491,0.00172491,0.00172491,0.00264744,0.00264744,0.00264744,0.00264744,0.00264744,0.00264744,0.00264744,0.00231701,0.00231701,0.00231701,0.00231701,0.00231701,0.00231701,0.00231701,0.00136504,0.00136504,0.00136504,0.00136504,0.00136504,0.00136504,0.00136504,0,0,0,0,0,0,0,0.00157485,0.00157485,0.00157485,0.00157485,0.00157485,0.00157485,0.00157485]

ldecay=[0.00205113,0.00205113,0.00205113,0.00205113,0.00205113,0.00205113,0.00205113,0.123135,0.13449,0.13449,0.13449,0.13449,0.13449,0.13449,0.131822,0.131822,0.131822,0.131822,0.131822,0.131822,0.131822,-0.0804032,-0.0804032,-0.0804032,-0.0804032,-0.0804032,-0.0804032,-0.0804032,0.0829957,0.0829957,0.0829957,0.0829957,0.0829957,0.0829957,0.0829957,-0.383478,-0.383478,-0.383478,-0.383478,-0.383478,-0.383478,-0.383478,0.111186,0.111186,0.111186,0.111186,0.111186,0.111186,0.111186,0.105715,0.105715,0.105715,0.105715,0.105715,0.105715,0.105715,0.123135,0.123135,0.123135,0.123135,0.123135,0.123135,0.123135,0.110282,0.110282,0.110282,0.110282,0.110282,0.110282,0.110282,0.122368,0.122368,0.122368,0.122368,0.122368,0.122368,0.122368,0.1032,0.1032,0.1032,0.1032,0.1032,0.1032,0.1032,0.126576,0.126576,0.126576,0.126576,0.126576,0.126576,0.126576,0.119424,0.119424,0.119424,0.119424,0.119424,0.119424,0.119424,0.0698905,0.0698905,0.0698905,0.0698905,0.0698905,0.0698905,0.0698905,0,0,0,0,0,0,0,0.105521,0.105521,0.105521,0.105521,0.105521,0.105521,0.105521]

a = where(exptime eq 100)

ps_open, filename='/Users/jkrick/iwic/test.ps',/portrait,/square,/color

!P.multi = [0,2,2]

plot, bias(a), newmean(a), psym = 2, xtitle = 'bias', ytitle ='noise in Mjy/sr', title = 'ch1,100s,  t=30K commanded', xrange=[350,800]
plot, bias(a), noisypix(a), psym = 2, xtitle = 'bias', ytitle ='fraction of noisy pixels', title = 'ch1, 100s, t=30K commanded', xrange=[350,800], /ylog, yrange=[1E-4,1]

oplot, [300,800], [12./(256.*256.), 12./(256.*256.)]
xyouts, 600, 12./(256.*256.), 'number of CR in 12s'
oplot, [300,800], [100./(256.*256.), 100./(256.*256.)]
xyouts, 600, 100./(256.*256.), 'number of CR in 100s'
oplot, [300,800], [200./(256.*256.), 200./(256.*256.)]
xyouts, 600, 200./(256.*256.), 'number of CR in 200s'


ps_close, /noprint,/noid



readcol, '/Users/jkrick/iwic/dark_summary/dark_summary_07_15_v2.csv', a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,format='A,A,I, I, I, I, I,I,I,F10.2,F10.2,F10.2,F10.2,I,F10.2,F10.2,F10.2,F10.2,F10.2,F10.2,I, F10.5,F10.2,F10.5,F10.5'

end
